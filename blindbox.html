<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" type="text/css" href="./css/blind_box.css" />
    <link rel="icon" type="image/png" href="./images/icon.ico" />
    <title>Lazada</title>
    <style>
      body {
        background: #f5f6fa;
        margin: 0;
        font-family: "Segoe UI", Arial, sans-serif;
      }
      .blindbox-banner {
        background: #b80000 url("./images/midautumn_bg.png") no-repeat
          center/cover;
        border-radius: 10px;
        margin: 24px auto 0 auto;
        max-width: 1100px;
        min-height: 480px;
        position: relative;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        padding-bottom: 40px;
      }
      .blindbox-title {
        position: absolute;
        left: 40px;
        top: 24px;
        z-index: 2;
        width: 520px;
        text-align: center;
      }
      .blindbox-title img {
        width: 100%;
        max-width: 520px;
      }
      .blindbox-rule-box {
        position: absolute;
        left: 30px;
        bottom: 30px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        padding: 24px 32px 18px 32px;
        min-width: 420px;
        max-width: 480px;
      }
      .blindbox-rule-title {
        color: #b80000;
        font-size: 22px;
        font-weight: 700;
        margin-bottom: 10px;
        letter-spacing: 1px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .blindbox-rule-title::before,
      .blindbox-rule-title::after {
        content: "";
        display: inline-block;
        width: 12px;
        height: 12px;
        background: #b80000;
        border-radius: 50%;
        margin: 0 6px;
      }
      .blindbox-rule-title::before {
        margin-left: 0;
      }
      .blindbox-rule-title::after {
        margin-right: 0;
      }
      .blindbox-rule-content {
        font-size: 16px;
        color: #222;
        margin-left: 8px;
      }
      .blindbox-rule-content ul {
        margin: 8px 0 0 0;
        padding-left: 18px;
      }
      .blindbox-rule-content li {
        margin-bottom: 4px;
        font-size: 15px;
      }
      /* Lucky wheel area */
      .blindbox-wheel-area {
        position: absolute;
        right: 30px;
        top: 40px;
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 2;
      }
      .blindbox-wheel-img {
        width: 370px;
        height: 370px;
        background: url("./images/luckywheel_big.png") no-repeat center/contain;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .blindbox-wheel-pointer {
        position: absolute;
        top: -38px;
        left: 50%;
        transform: translateX(-50%);
        width: 54px;
        height: 54px;
        z-index: 3;
      }
      .blindbox-spin-btn {
        position: static;
        margin-top: 32px;
        background: linear-gradient(180deg, #ffe082 0%, #ffb300 100%);
        color: #fff;
        font-size: 32px;
        font-weight: 900;
        border: none;
        border-radius: 32px;
        padding: 12px 54px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.12);
        cursor: pointer;
        letter-spacing: 2px;
        text-shadow: 1px 1px 2px #b80000;
        transition: background 0.2s;
      }
      .blindbox-spin-btn:active {
        background: linear-gradient(180deg, #ffd54f 0%, #ffa000 100%);
      }
      /* Popup */
      .result-popup {
        position: fixed;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.25);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .result-popup-content {
        background: #fff;
        border-radius: 16px;
        padding: 38px 44px 28px 44px;
        text-align: center;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.18);
        min-width: 320px;
        position: relative;
      }
      .result-popup-content span {
        font-size: 22px;
        font-weight: 700;
        color: #b80000;
      }
      .result-popup-close {
        margin-top: 18px;
        background: #ff6a00;
        color: #fff;
        border: none;
        border-radius: 7px;
        font-size: 17px;
        font-weight: 700;
        padding: 10px 32px;
        cursor: pointer;
        transition: background 0.2s;
      }
      .result-popup-close:hover {
        background: #ff8c42;
      }
      /* Confetti */
      .confetti-container {
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        pointer-events: none;
        z-index: 10;
      }
      .confetti {
        position: absolute;
        width: 12px;
        height: 18px;
        border-radius: 4px;
        opacity: 0.85;
        animation: confetti-fall 1.3s linear forwards;
      }
      @keyframes confetti-fall {
        0% {
          transform: translateY(0) rotate(0deg);
        }
        100% {
          transform: translateY(180px) rotate(360deg);
        }
      }
      @media (max-width: 900px) {
        .blindbox-banner {
          min-width: unset;
          max-width: 100%;
        }
        .blindbox-title,
        .blindbox-rule-box,
        .blindbox-wheel-area {
          position: static;
          width: 100%;
        }
        .blindbox-wheel-img {
          width: 90vw;
          height: 90vw;
          max-width: 350px;
          max-height: 350px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Top strip -->
    <div class="top-strip">
      <div
        class="container"
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
        "
      >
        <div class="top-links">
          <a href="#">ChƒÉm s√≥c kh√°ch h√†ng</a>
          <a href="./orderdetail.html">Ki·ªÉm tra ƒë∆°n h√†ng</a>
        </div>
        <div class="top-actions">
          <a href="#">ƒêƒÉng nh·∫≠p</a>
          <a href="#">ƒêƒÉng k√Ω</a>
        </div>
      </div>
    </div>
    <!-- Header -->
    <header class="main-header">
      <div
        class="container"
        style="display: flex; align-items: center; gap: 32px"
      >
        <div class="logo">
          <a href="./index.html" aria-label="Trang ch·ªß Lazada">
            <img
              src="./images/lazada_icon.png"
              alt="Logo"
              style="height: 48px"
            />
          </a>
        </div>
        <div class="search-wrap" style="flex: 1">
          <div
            class="search-row"
            style="display: flex; align-items: center; gap: 12px"
          >
            <input
              type="text"
              placeholder="T√¨m ki·∫øm tr√™n Lazada, s·∫£n ph·∫©m, th∆∞∆°ng hi·ªáu..."
              aria-label="T√¨m ki·∫øm"
              class="search-input"
              style="
                flex: 1;
                max-width: 700px;
                padding: 16px 22px;
                font-size: 18px;
                border-radius: 32px;
                border: 1.5px solid #eee;
              "
            />
            <button
              aria-label="T√¨m ki·∫øm"
              class="search-btn"
              style="
                background: #ff6a00;
                color: #fff;
                font-size: 18px;
                padding: 12px 36px;
                border-radius: 32px;
                border: none;
                font-weight: 700;
                cursor: pointer;
              "
            >
              T√¨m ki·∫øm
            </button>
          </div>
        </div>
        <div class="cart">
          <button
            class="cart-btn"
            aria-label="Gi·ªè h√†ng"
            style="background: none; border: none; cursor: pointer"
          >
            <img
              src="./images/shopping_cart.png"
              alt="Gi·ªè h√†ng"
              style="height: 40px"
            />
          </button>
        </div>
      </div>
      <div
        class="mini-features"
        aria-hidden="true"
        style="
          display: flex;
          gap: 32px;
          justify-content: center;
          margin: 18px 0 0 0;
          font-size: 17px;
          color: #555;
        "
      >
        <span style="display: flex; align-items: center; gap: 6px"
          ><span style="color: #ff2d55">üè∑</span> LazMall</span
        >
        <span style="display: flex; align-items: center; gap: 6px"
          ><span style="color: #00bcd4">üí≥</span> M√£ Gi·∫£m Gi√°</span
        >
        <span style="display: flex; align-items: center; gap: 6px"
          ><span style="color: #ff6a00">üîñ</span> N·∫°p Th·∫ª & eVoucher</span
        >
        <span style="display: flex; align-items: center; gap: 6px"
          ><span style="color: #0097a7">üåç</span> LazGlobal</span
        >
      </div>
    </header>

    <!-- Main Blindbox Banner -->
    <div class="blindbox-banner">
      <!-- B√™n tr√°i: ch·ªâ l√† h√¨nh ·∫£nh b·∫°n cung c·∫•p -->
      <div
        class="blindbox-left-img"
        style="
          position: absolute;
          left: 0;
          top: 0;
          bottom: 0;
          width: 54%;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1;
        "
      >
        <img
          src="./images/midautumn_left.png"
          alt="V√≤ng xoay trung thu"
          style="
            max-width: 98%;
            max-height: 98%;
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
          "
        />
      </div>
      <!-- Lucky Wheel Group b√™n ph·∫£i -->
      <div
        class="blindbox-wheel-group"
        style="
          position: absolute;
          right: 32px;
          top: 50%;
          transform: translateY(-50%);
          display: flex;
          flex-direction: column;
          align-items: center;
          z-index: 10;
        "
      >
        <div style="position: relative; width: 370px; height: 370px">
          <!-- SVG Lucky Wheel -->
          <svg
            id="luckyWheelSVG"
            width="370"
            height="370"
            viewBox="0 0 370 370"
            style="display: block; z-index: 2"
          >
            <g id="wheelGroup"></g>
          </svg>
          <!-- Pointer -->
          <div
            style="
              position: absolute;
              right: -30px;
              top: 50%;
              transform: translateY(-50%);
              z-index: 3;
            "
          >
            <svg width="60" height="60" style="rotate: 180deg">
              <polygon
                points="60,30 0,10 0,50"
                fill="#fff"
                stroke="#bbb"
                stroke-width="3"
              />
              <circle cx="18" cy="30" r="8" fill="#bbb" />
            </svg>
          </div>
          <!-- Text ph·∫ßn th∆∞·ªüng -->
          <div id="wheelLabels"></div>
        </div>
        <button class="blindbox-spin-btn" id="spinBtn" style="margin-top: 32px">
          QUAY
        </button>
      </div>
    </div>
    <!-- Popup k·∫øt qu·∫£ quay -->
    <div id="resultPopup" class="result-popup" style="display: none">
      <div class="result-popup-content">
        <span id="resultText"></span>
        <button class="result-popup-close" onclick="closeResultPopup()">
          ƒê√≥ng
        </button>
        <div id="confettiContainer" class="confetti-container"></div>
      </div>
    </div>
    <script>
      let wheel = document.getElementById("wheel");
      let spinBtn = document.getElementById("spinBtn");
      let value = Math.ceil(Math.random() * 3600);
      let confettiContainer = document.getElementById("confettiContainer");
      let currentRotation = 0;
      // C√°c ph·∫ßn th∆∞·ªüng, th·ª© t·ª± theo chi·ªÅu kim ƒë·ªìng h·ªì b·∫Øt ƒë·∫ßu t·ª´ tr√™n c√πng
      const prizes = [
        "GI·∫¢M 20%",
        "IPHONE 17",
        "GI·∫¢M 10%",
        "FREESHIP",
        "GI·∫¢M 50K",
        "GI·∫¢M 10%",
        "FREESHIP",
        "GI·∫¢M 30%",
      ];
      const colors = [
        "#1e90ff",
        "#ffa500",
        "#2ecc71",
        "#e74c3c",
        "#1e90ff",
        "#ffa500",
        "#2ecc71",
        "#e74c3c",
      ];
      const svg = document.getElementById("luckyWheelSVG");
      const wheelGroup = document.getElementById("wheelGroup");
      const segCount = prizes.length;
      const cx = 185,
        cy = 185,
        r = 170;
      wheelGroup.innerHTML = "";
      for (let i = 0; i < segCount; i++) {
        const startAngle = (i / segCount) * 2 * Math.PI;
        const endAngle = ((i + 1) / segCount) * 2 * Math.PI;
        // L√°t
        const x1 = cx + r * Math.cos(startAngle);
        const y1 = cy + r * Math.sin(startAngle);
        const x2 = cx + r * Math.cos(endAngle);
        const y2 = cy + r * Math.sin(endAngle);
        const largeArc = endAngle - startAngle > Math.PI ? 1 : 0;
        const d = `
          M ${cx} ${cy}
          L ${x1} ${y1}
          A ${r} ${r} 0 ${largeArc} 1 ${x2} ${y2}
          Z
        `;
        const path = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "path"
        );
        path.setAttribute("d", d);
        path.setAttribute("fill", colors[i]);
        path.setAttribute("stroke", "#fff");
        path.setAttribute("stroke-width", "8");
        wheelGroup.appendChild(path);

        // V·∫°ch chia
        const line = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "line"
        );
        line.setAttribute("x1", cx);
        line.setAttribute("y1", cy);
        line.setAttribute("x2", x1);
        line.setAttribute("y2", y1);
        line.setAttribute("stroke", "#fff");
        line.setAttribute("stroke-width", "4");
        wheelGroup.appendChild(line);

        // Text ph·∫ßn th∆∞·ªüng (SVG <text>)
        const angle = (startAngle + endAngle) / 2;
        const labelR = r - 60;
        const labelX = cx + labelR * Math.cos(angle);
        const labelY = cy + labelR * Math.sin(angle);
        const text = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "text"
        );
        text.setAttribute("x", labelX);
        text.setAttribute("y", labelY);
        text.setAttribute("fill", "#fff");
        text.setAttribute("font-size", "20");
        text.setAttribute("font-family", "Arial, sans-serif");
        text.setAttribute("font-weight", "bold");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("alignment-baseline", "middle");
        // Xoay text cho th·∫≥ng theo l√°t
        const deg = (angle * 180) / Math.PI;
        text.setAttribute("transform", `rotate(${deg},${labelX},${labelY})`);
        text.textContent = prizes[i];
        wheelGroup.appendChild(text);
      }
      spinBtn.onclick = function () {
        const spinAmount = 720 + Math.floor(Math.random() * 2881);
        const finalRotation = currentRotation + spinAmount;
        svg.style.transition = "transform 4.5s cubic-bezier(.25,.8,.25,1)";
        svg.style.transform = `rotate(${finalRotation}deg)`;
        spinBtn.style.pointerEvents = "none";
        setTimeout(() => {
          spinBtn.style.pointerEvents = "auto";
          currentRotation = finalRotation;
          showResultPopup(finalRotation);
        }, 4500);
      };
      function showResultPopup(spinDeg) {
        // T√≠nh ph·∫ßn tr√∫ng d·ª±a tr√™n g√≥c quay
        const segCount = prizes.length;
        let currentDeg = spinDeg % 360;
        let idx = Math.floor(((360 - currentDeg) % 360) / (360 / segCount));
        let prize = prizes[idx];
        document.getElementById(
          "resultText"
        ).innerHTML = `B·∫°n ƒë√£ quay tr√∫ng: <b>${prize}</b> üéâ`;
        document.getElementById("resultPopup").style.display = "flex";
        showConfetti();
      }
      function showConfetti() {
        const container = document.getElementById("confettiContainer");
        container.innerHTML = "";
        for (let i = 0; i < 32; i++) {
          let conf = document.createElement("div");
          conf.className = "confetti";
          conf.style.left = 60 + Math.random() * 180 + "px";
          conf.style.bottom = "0px";
          conf.style.background = randomColor();
          container.appendChild(conf);
        }
        setTimeout(() => {
          container.innerHTML = "";
        }, 1300);
      }
      function randomColor() {
        const colors = [
          "#db7093",
          "#ff6347",
          "#ff8c00",
          "#ffd700",
          "#90ee90",
          "#1e90ff",
          "#9370db",
          "#ff69b4",
        ];
        return colors[Math.floor(Math.random() * colors.length)];
      }
      function closeResultPopup() {
        document.getElementById("resultPopup").style.display = "none";
      }
    </script>
  </body>
</html>
